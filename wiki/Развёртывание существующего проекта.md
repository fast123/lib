<div class="article-content"><p>Этапы развёртывания существующего в репозитории проекта на компьютере разработчика или на сервере. Два случая: когда в репозитории есть или отсутствует ветка <code role="button">bitrix-core</code>.</p><h2 role="button">Случай 1. Когда ветка <code role="button">bitrix-core</code> есть в репозитории проекта.</h2><p>Все действия производятся в корневом каталоге проекта:</p><ol><li>Если действия выполняются на сервере, то может потребоваться добавить SSH-ключ сервера в репозиторий проекта (см. приложение 1)</li><li>Склонировать репозиторий (<span style="color: rgb(33, 41, 52);">обязательно поставить точку в конце как в примере. </span><span style="font-size: 12px; color: rgb(150, 150, 1500);">Так же если сервер спросит "Are you sure you want to continue connecting (yes/no)?", то ответить "yes"</span>): <code role="button">git clone SSH_ссылка_на_удалённый_репозиторий .</code><span class="ql-cursor">﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿</span></li><li>Склонировать ветку <code role="button">bitrix-core</code> в каталог&nbsp;<code role="button">bitrix</code> проекта (каталог создастся автоматическ):&nbsp;<code role="button">git clone SSH_ссылка_на_удалённый_репозиторий -b bitrix-core bitrix</code></li><li>Скопировать папку upload с основной версии сайта</li><li>Создать <u>копии</u> файлов <code role="button">.htaccess.example</code>, <code role="button">/bitrix/.settings.php.example</code>, <code role="button">/bitrix/php_interface/dbconn.php.example</code>, <code role="button">/bitrix/php_interface/after_connect.php.example</code>, <code role="button">/bitrix/php_interface/after_connect_d7.php.example</code>&nbsp;чтобы в именах скопированных файлов отсутствовало <code role="button">.example</code>.</li><li>Взять бекап базы данных с основной версии проекта и восстановить базу данных на текущей используя скрипт <a href="http://www.1c-bitrix.ru/download/scripts/restore.php" target="_blank">restore.php</a>&nbsp;(см. приложение 2)</li><li>После успешного восстановления базы данных выполнить проверку системы (Настройка -&gt; Инструменты -&gt; Проверка системы) и устранить ошибки.</li></ol><p><br></p><h2 role="button">Случай 2. Когда ветки&nbsp;<code role="button">bitrix-core</code>&nbsp;в репозитории проекта нет.</h2><p>Все действия производятся в корневом каталоге проекта:</p><ol><li>Если действия выполняются на сервере, то может потребоваться добавить SSH-ключ сервера в репозиторий проекта (см. приложение 1)</li><li>Склонировать репозиторий (обязательно поставить точку в конце как в примере):&nbsp;<code role="button">git clone SSH_ссылка_на_удалённый_репозиторий .</code><span class="ql-cursor">﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿</span></li><li>Скопировать папку upload с основной версии сайта</li><li>Создать&nbsp;<u>копии</u>&nbsp;файлов&nbsp;<code role="button">.htaccess.example</code>,&nbsp;<code role="button">/bitrix/.settings.php.example</code>,&nbsp;<code role="button">/bitrix/php_interface/dbconn.php.example</code>,&nbsp;<code role="button">/bitrix/php_interface/after_connect.php.example</code>,&nbsp;<code role="button">/bitrix/php_interface/after_connect_d7.php.example</code>&nbsp;чтобы в именах скопированных файлов отсутствовало&nbsp;<code role="button">.example</code>.</li><li>Взять бекап базы данных с основной версии проекта и восстановить базу данных на текущей используя скрипт&nbsp;<a href="http://www.1c-bitrix.ru/download/scripts/restore.php" target="_blank">restore.php</a></li><li>После успешного восстановления базы данных выполнить проверку системы (Настройка -&gt; Инструменты -&gt; Проверка системы) и устранить ошибки.</li></ol><p><br></p><p><br></p><h3 role="button">Приложение 1. Добавление SSH-ключа сервера в репозиторий проекта</h3><p>Проверить наличие SSH-ключа на сервере можно следующей командой:</p><p><code role="button">cat ~/.ssh/id_rsa.pub</code></p><p>Команда должна выполняться от имени того же пользователя от чьего работает web-сервер.</p><p>Если результатом является сообщение об ошибке, то ключа нет и его нужно создать с помощью команды: <code role="button">ssh-keygen</code>&nbsp;. При генерации на все вопросы ответить значением по умолчанию (просто Enter). Теперь команда&nbsp;<code role="button">cat ~/.ssh/id_rsa.pub</code>&nbsp;выведет на экран SSH-ключ. Его нужно скопировать и добавить в репозиторий. Для этого в веб-интерфейсе gitlab в разделе <code role="button">Settings -&gt; CI/CD -&gt; Deploy Keys</code>&nbsp;добавить в поле <code role="button">Key</code> этот ключ; в поле <code role="button">Title</code>&nbsp;указать адрес сайта (пример: "velocityk.ru"); нажать <code role="button">Add</code>.</p><p>Теперь репозиторий может идентифицировать сайт и отдавать ему данные.</p><p><br></p><h2 role="button">Приложение 2. Восстановление бекапа через restore.php</h2><p>Для восстановления из бекапа необходимо:</p><ol><li>Сохранить в корень сайта файл(ы) бекапа</li><li> Сохранить файл <a href="http://www.1c-bitrix.ru/download/scripts/restore.php" target="_blank">restore.php</a>&nbsp;так же в корень сайта</li><li>Запустить файл restore.php из браузера: http://домена_сайта/restore.php. Следовать шагам установки. На шаге "Загрузка резервной копии" выбрать "Архив загружен в корневую папку сервера"</li></ol><p>Полная статья по восстановлению: <a href="https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=35&amp;LESSON_ID=6979&amp;LESSON_PATH=3906.4833.6979" target="_blank">ссылка</a></p></div>